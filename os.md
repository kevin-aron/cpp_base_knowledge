# 操作系统-知识总结

### 第一章

**操作系统的基本概念**

==指受控制和管理整个计算机系统的硬件与软件资源，合理地组织、调度计算机的工作与资源的分配，进而为用户和其它软件提供方便接口与环境的集合资源。==

`组织/调度` `计算机工作/资源分配`

操作系统是计算机系统中最基本的**系统软件**。

<br>

**操作系统特征**

`并发` 两个事情或多个事情在同一时间间隔内发生。通过**分时**实现。

`共享` 系统中的资源可供内存中多个并发执行的进程同时使用。有互斥共享方式(一段时间内只允许有一个进程访问该资源)、同时访问方式(一段时间内运行多个进程"同时"访问)。

`虚拟` 把物理上的实体变为若干逻辑上的对应物。通过**多道程序设计技术**，采用让多道程序并发执行的方法，来分时使用一个处理器(把一个物理CPU虚拟为多个逻辑CPU)。虚拟技术归纳为①时分复用技术②空分复用技术。

```
多道程序设计技术：多道、宏观上并行、微观上串行。
多道：计算机内存中同时存放多道相互独立的程序。
```

`异步` 多道程序环境允许多个程序并发执行，但是由于资源有限，进程的执行并不是一贯到底的，而是走走停停的，以不可预知的速度向前推进。

<br>

**操作系统的目标和功能**

处理机管理、存储器管理、设备管理和文件管理。

* 系统资源的管理者

* 用户与计算机硬件系统之间的接口

  `联机命令接口` 交互式命令接口，适用于分时或者实时。

  `脱机命令接口` 批处理命令接口，适用于批处理。

* 实现了对计算机资源的扩充

<br>

**操作系统发展史**

* 手工操作阶段(无操作系统)

  ```
  人工干预 程序装入、运行、结果的输出等。
  ```

* 批处理阶段(操作系统开始出现)

  ```shell
  #单道批处理
  系统对作业成批进行，但内存中始终保持只有一道作业。
  自动性。磁带上的一批作业能自动逐个运行。
  顺序性。磁带上的作业顺序地进入内存，自然先调入内存的作业先完成。
  单道性。只运行调入内存的一道程序，程序完成或发生异常，再继续后继内存。
  #多道批处理
  多个程序同时进入内存，并且允许它们在CPU中交替运行。
  涉及到各种资源的调度问题。
  多道。内存中同时存放着多道相互独立的程序。
  宏观上并行。
  微观上串行。轮流占用CPU。
  不提供人机交互能能力(异步)
  ```

* 分时操作系统

  ```
  分时技术，指把处理器的运行时间分成很短的时间片，按时间片轮流把处理器分配给各联机作业使用。
  ```

* 实时操作系统

  ```
  为了能限制某个时间限制内完成某些紧急任务而不需要时间片排队，诞生了实时操作系统。
  ```

* 网络操作系统和分布式计算机系统

* 个人计算机操作系统

<br>

**甘特图**⭐⭐

王道2024版P12-03

`处理器、打设备等资源是不能让两个程序同时使用的`

<br>

**操作系统运行环境**

* 处理器的运行模式

  ````shell
  CPU通常执行两种指令：操作系统内核程序；用户自编程序。
  前者是后者的管理者。
  前者(内核程序)(管理程序) 需要执行一些特权指令。
  后者(用户程序)(被管理程序) 不能执行特权指令。
  
  #特权指令
  不允许用户直接使用的指令。
  I/O操作、置中断指令、存取用于内存保护的寄存器、送程序状态字到程序状态字寄存器等。
  #非特权指令
  允许用户直接使用。
  不能直接访问系统的软硬件资源。
  仅能访问用户的地址空间。
  
  CPU运行模式：用户态(目态)、核心态(管态、内核态)。
  通过“访管指令”，将系统切换为核心态。
  通过“某特权指令”，将系统切换为用户态。
  
  时钟管理/中断机制/原语/系统控制的数据结构及处理
  ## 核心态指令 实际上包括系统调用类指令和一些对时钟、中断、原语的指令。
  ````

* 中断和异常的概念

  ```shell
  用户态和核心态之间的切换
  操作系统内核 work 核心态
  用户程序 work 用户态
  ## CPU上层程序 进入 核心态 的唯一途径：中断(外中断)或异常(内中断)。
  ```

  $$ 中断\left\{ \begin{matrix} 外部中断(硬件)& \begin{matrix} 故障-软件中断\\自陷-软件中断\\终止-硬件中断\end{matrix}   \\ 内部异常  \end{matrix} \right. $$

* 系统调用

  ```shell
  设备管理、文件管理、进程控制、进程通信、内存管理。
  $注意 用户态进入核心态，不仅状态需要切换，而且所用的用户堆栈也要切换为系统堆栈，但系统堆栈同样属于该进程。
  程序由用户态转到核心态，会用到访管指令(陷阱指令)，在用户态下使用。
  ```
  
  ![image-20230331214916956](https://raw.githubusercontent.com/kevin-aron/photo/main/os/image-20230331214916956.png?token=GHSAT0AAAAAAB746PMNJRBYEIIJGBJSCZLOZBG6PNQ)

**操作系统结构**

分层法（略）。

模块化（略）。

宏内核、微内核、外核。

#### 操作系统的引导(开机流程😀)

①激活CPU。读取ROM中的boot程序，将**指令寄存器置为**BIOS(基本输入/输出系统)的**第一条指令**，即开始执行BIOS指令。

②硬件自检。若无故障，屏幕会显示CPU、内存、硬盘等信息。

③加载带有操作系统的硬盘。BIOS开始读取Boot Sequence，把控制权交给启动顺序排在第一位的存储设备，然后CPU将该存储设备引导扇区的内容加载到内存中。

④加载主引导记录MBR。通过标识符区分引导硬盘和非引导硬盘。

⑤扫描硬盘分区表，并加载硬盘活动分区。

⑥加载分区引导记录PBR。其作用是寻找并激活分区根目录下用于引导操作系统的程序。

⑦加载启动管理器。

⑧加载操作系统。

**虚拟机**

第一类虚拟机管理程序：在裸机上运行并且具备多道程序功能。

第二类虚拟机管理程序：依赖于Windows、Linux等操作系统分配和调度资源的程序，很像一个普通的进程。(`VMware Workstation`)

#### 第一章疑难点

